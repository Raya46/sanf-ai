(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{16093:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>F});var s=t(95155),n=t(83893),l=t(66695);function i(e){let{title:a,description:t,icon:n,bgColor:i,iconColor:o}=e;return(0,s.jsxs)(l.Zp,{className:"bg-[#F8FAFF] flex flex-col items-center justify-center border border-[#E0F7FA]",children:[(0,s.jsx)("div",{className:"rounded-full p-2",style:{backgroundColor:i,color:o},children:n}),(0,s.jsx)(l.ZB,{children:a}),(0,s.jsx)(l.BT,{className:"text-center",children:t})]})}var o=t(30285),r=t(22346),c=t(43453),d=t(1243),p=t(14186),h=t(97210),x=t(99890),m=t(91788),u=t(12115),f=t(68856),j=t(54165),g=t(88539),w=t(35695),y=t(95879),N=t(9727),b=t(19144),v=t(51154),C=t(75109),k=t(58292);function A(e){let{isOpen:a,onClose:t,applicationData:n}=e,[l,i]=(0,u.useState)(!1),r=(0,u.useRef)(null);(0,w.useRouter)();let c=(0,C.hG)({extensions:[k.A],content:"",immediatelyRender:!1,onUpdate:e=>{let{editor:a}=e;console.log(a)}}),{input:d,handleInputChange:p,handleSubmit:h,isLoading:x,setInput:m}=(0,y.Y_)({api:"/api/applications/".concat(null==n?void 0:n.id,"/enhance-ai"),initialMessages:[],onFinish:e=>{c&&c.commands.setContent(e.content),m(""),i(!1)},onError:e=>{console.error("AI enhancement error:",e)}});(0,u.useEffect)(()=>{c&&n&&n.ai_analysis&&c.commands.setContent(n.ai_analysis)},[c,n]);let f=async()=>{if(!(null==n?void 0:n.id)||!c)return void console.error("Application ID or editor is missing.");let e=c.getHTML();try{if(!(await fetch("/api/applications/".concat(n.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({ai_analysis:e})})).ok)throw Error("Failed to update AI analysis.");console.log("AI analysis updated successfully!");let a=window.open("","_blank");a?(a.document.write("\n          <html>\n            <head>\n              <title>Credit Analysis Report</title>\n              <style>\n                body { font-family: Arial, sans-serif; margin: 20px; }\n                h1, h2, h3 { color: #333; }\n                b, strong { font-weight: bold; }\n                i, em { font-style: italic; }\n                ul, ol { margin-left: 20px; }\n                p { margin-bottom: 10px; }\n              </style>\n            </head>\n            <body>\n              ".concat(e,"\n            </body>\n          </html>\n        ")),a.document.close(),a.print()):console.error("Failed to open print window."),t()}catch(e){console.error("Error updating AI analysis:",e)}};return c?(0,s.jsx)(j.lG,{open:a,onOpenChange:t,children:(0,s.jsxs)(j.Cf,{className:"sm:max-w-[800px] h-[90vh] flex flex-col",children:[(0,s.jsxs)(j.c7,{children:[(0,s.jsx)(j.L3,{children:"Export Analysis to PDF"}),(0,s.jsx)(j.rr,{children:"Review and edit the AI analysis results before exporting."})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden p-4 border rounded-lg bg-white shadow-inner flex flex-col",children:[(0,s.jsxs)("div",{className:"flex gap-1 mb-2",children:[(0,s.jsx)(o.$,{onClick:()=>c.chain().focus().toggleBold().run(),disabled:!c.can().chain().focus().toggleBold().run(),variant:"outline",size:"sm",children:(0,s.jsx)(N.A,{className:"h-4 w-4"})}),(0,s.jsx)(o.$,{onClick:()=>c.chain().focus().toggleItalic().run(),disabled:!c.can().chain().focus().toggleItalic().run(),variant:"outline",size:"sm",children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,s.jsx)(C.$Z,{editor:c,className:"w-full h-full overflow-y-auto text-base prose max-w-none"}),l&&(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!c)return;let a={currentContent:c.getHTML(),userPrompt:d};h(new Event("submit"),{body:a})},className:"flex gap-2 mt-2",children:[(0,s.jsx)(g.T,{ref:r,value:d,onChange:p,placeholder:"Enter your prompt to enhance with AI...",className:"min-h-[40px] max-h-[100px] resize-none",disabled:x}),(0,s.jsx)(o.$,{type:"submit",disabled:x||!d.trim(),children:x?(0,s.jsx)(v.A,{className:"animate-spin"}):"Enhance"})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,s.jsx)(o.$,{variant:"outline",onClick:()=>i(!l),children:l?"Hide AI Prompt":"Enhance with AI"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.$,{variant:"outline",onClick:t,children:"Cancel"}),(0,s.jsx)(o.$,{onClick:f,children:"Done"})]})]})]})}):null}function E(e){let{activeView:a,applicationId:t}=e,[n,l]=(0,u.useState)(null),[j,g]=(0,u.useState)(!0),[y,N]=(0,u.useState)(!1),b=(0,w.useRouter)();return(0,u.useEffect)(()=>{if(!t)return void g(!1);(async()=>{g(!0);try{let e=await fetch("/api/applications/".concat(t));if(!e.ok)throw Error("Failed to fetch application data");let a=await e.json();l(a)}catch(e){console.error(e),l(null)}finally{g(!1)}})()},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"sticky top-4 flex flex-col w-1/4 bg-white rounded-lg shadow-lg h-full overflow-y-auto",children:[(0,s.jsx)("h1",{className:"text-center font-bold my-4",children:"Analytics & Status"}),(0,s.jsx)("div",{className:"mx-4 mb-2",children:(0,s.jsx)(r.w,{})}),(0,s.jsxs)("div",{className:"flex flex-col p-4 gap-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.E,{className:"h-24 w-full"}),(0,s.jsx)(f.E,{className:"h-24 w-full"})]}):n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{icon:(0,s.jsx)(c.A,{className:"w-8 h-8"}),title:"".concat(n.probability_approval,"%"),description:"Probabilitas Persetujuan",bgColor:"transparent",iconColor:"#007BFF"}),(0,s.jsx)(i,{icon:(0,s.jsx)(d.A,{className:"w-8 h-8"}),title:n.overall_indicator,description:"Indikator Risiko",bgColor:"transparent",iconColor:"#FF9800"})]}):(0,s.jsx)("p",{className:"col-span-2 text-center text-gray-500",children:"Data aplikasi tidak ditemukan."}),"credit-application"===a&&(0,s.jsx)(s.Fragment,{children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.E,{className:"h-24 w-full"}),(0,s.jsx)(f.E,{className:"h-24 w-full"})]}):n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{icon:(0,s.jsx)(p.A,{className:"w-8 h-8"}),title:"".concat(n.document_validation_percentage,"%"),description:"Progress Validasi Dokumen",bgColor:"transparent",iconColor:"#007BFF"}),(0,s.jsx)(i,{icon:(0,s.jsx)(h.A,{className:"w-8 h-8"}),title:"".concat(n.estimated_analysis_time_minutes," Menit"),description:"Estimasi Waktu Analisis",bgColor:"transparent",iconColor:"#007BFF"})]}):null})]}),"credit-application"===a&&(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("p",{children:"Tautan Cepat"}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("p",{children:"Lihat Laporan Lengkap"})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("p",{children:"Lihat Laporan Lengkap"})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("p",{children:"Lihat Laporan Lengkap"})]}),(0,s.jsxs)(o.$,{className:"bg-blue-600 flex flex-row mx-4",onClick:()=>N(!0),disabled:!n,children:[(0,s.jsx)(m.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Ekspor PDF"})]}),(0,s.jsx)(o.$,{className:"mx-4",onClick:()=>b.push("/dashboard/".concat(t)),children:(0,s.jsx)("span",{children:"Dashboard"})})]})]})]}),(0,s.jsx)(A,{isOpen:y,onClose:()=>N(!1),applicationData:n})]})}function F(){let e=(0,w.useParams)().applicationId,[a,t]=(0,u.useState)("credit-application"),[l,i]=(0,u.useState)(null),[o,r]=(0,u.useState)(!0),[c,d]=(0,u.useState)(null),[p,h]=(0,u.useState)([]),[x,m]=(0,u.useState)(!0);return(0,u.useEffect)(()=>{e&&(async()=>{r(!0),d(null);try{let a=await fetch("/api/applications/".concat(e));if(!a.ok)throw Error("Error: ".concat(a.status));let t=await a.json();i(t)}catch(e){d(e),console.error("Failed to fetch application data:",e)}finally{r(!1)}})()},[e]),(0,u.useEffect)(()=>{e&&(async()=>{m(!0);try{let a=await fetch("/api/applications/".concat(e,"/chat"));if(!a.ok)throw Error("Failed to fetch chat history");let t=await a.json();h(t)}catch(e){console.error("Chat history fetch error:",e)}finally{m(!1)}})()},[e]),(0,s.jsxs)("div",{className:"flex h-screen p-4 gap-4",children:[(0,s.jsx)(n.G,{activeView:a,setActiveView:t,applicationData:l,isLoadingData:o,errorData:c,initialMessages:p,isLoadingChat:x,applicationId:e}),(0,s.jsx)(E,{applicationId:e,activeView:a})]})}},22346:(e,a,t)=>{"use strict";t.d(a,{w:()=>i});var s=t(95155);t(12115);var n=t(87489),l=t(59434);function i(e){let{className:a,orientation:t="horizontal",decorative:i=!0,...o}=e;return(0,s.jsx)(n.b,{"data-slot":"separator",decorative:i,orientation:t,className:(0,l.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...o})}},54165:(e,a,t)=>{"use strict";t.d(a,{Cf:()=>h,Es:()=>m,L3:()=>u,c7:()=>x,lG:()=>r,rr:()=>f,zM:()=>c});var s=t(95155),n=t(12115),l=t(15452),i=t(54416),o=t(59434);let r=l.bL,c=l.l9,d=l.ZL;l.bm;let p=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.hJ,{ref:a,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});p.displayName=l.hJ.displayName;let h=n.forwardRef((e,a)=>{let{className:t,children:n,...r}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(p,{}),(0,s.jsxs)(l.UC,{ref:a,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[n,(0,s.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=l.UC.displayName;let x=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};x.displayName="DialogHeader";let m=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};m.displayName="DialogFooter";let u=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.hE,{ref:a,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});u.displayName=l.hE.displayName;let f=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(l.VY,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",t),...n})});f.displayName=l.VY.displayName},61981:(e,a,t)=>{Promise.resolve().then(t.bind(t,16093))}},e=>{var a=a=>e(e.s=a);e.O(0,[4,277,352,576,587,148,133,92,423,893,441,684,358],()=>a(61981)),_N_E=e.O()}]);